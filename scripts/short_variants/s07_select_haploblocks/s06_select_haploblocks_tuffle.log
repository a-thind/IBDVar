./s06_select_haploblocks_tuffle.sh
Mon Jun 20 14:40:13 UTC 2022

Detecting haploblocks using truffle...

Input VCF file (annotated with ClinVar): /home/share/data/s04_annotate/IHCAPX8_dragen_joint.clinvar.reheaded.vcf.gz
Output folder: /home/share/data/s07_select_haploblocks/truffle


     _               __  __ _       
    | |             / _|/ _| |      
    | |_ _ __ _   _| |_| |_| | ___  
    | __| '__| | | |  _|  _| |/ _ \ 
    | |_| |  | |_| | | | | | |  __/ 
     \__|_|   \__,_|_| |_| |_|\___| 
        
         - TRUFFLE v1.38 -    



***
*** Non-commerical and educational use license.
***


[*]  Options in effect: 
      -   Input file: /home/share/data/s04_annotate/IHCAPX8_dragen_joint.clinvar.reheaded.vcf.gz
      -   Number of CPUs: 4

      -   Reporting threshold: all pairs

      -   Segment reporting: YES

      -   Input file name: /home/share/data/s04_annotate/IHCAPX8_dragen_joint.clinvar.reheaded.vcf.gz
      -   Opening output file /home/share/data/s07_select_haploblocks/truffle/IHCAPX8_vcf_truffle.ibd  
      -   Opening output file /home/share/data/s07_select_haploblocks/truffle/IHCAPX8_vcf_truffle.segments  
      -   Number of samples: 3

      -   Allocation genotype vector  npeople=19 nvars=200000
      -   GenotypeMatrix: allocating 3 MB of memory
      -   Excluding variants with missing rate > 0.020 (0 samples)

      -   Excluding variants with allele frequency  < 0.060

      -   Reading chromosome chr1 (pos=0)
      -   Allocation genotype vector  npeople=19 nvars=400000
      -   GenotypeMatrix: allocating 7 MB of memory
      -   Allocation genotype vector  npeople=19 nvars=800000
      -   GenotypeMatrix: allocating 14 MB of memory
      -   Reading chromosome chr2 (pos=487717)
      -   Allocation genotype vector  npeople=19 nvars=1600000
      -   GenotypeMatrix: allocating 28 MB of memory
      -          944370 variants read -      807186 variants kept -     311 MB - speed:    331.84 MB/sec 
      -   Reading chromosome chr3 (pos=1011036)
      -   Reading chromosome chr4 (pos=1449161)
      -   Allocation genotype vector  npeople=19 nvars=3200000
      -   GenotypeMatrix: allocating 57 MB of memory
      -         1900597 variants read -     1636194 variants kept -     624 MB - speed:    327.75 MB/sec 
      -   Reading chromosome chr5 (pos=1902801)
      -   Reading chromosome chr6 (pos=2302261)
      -         2858814 variants read -     2479645 variants kept -     936 MB - speed:    331.41 MB/sec 
      -   Reading chromosome chr7 (pos=2717285)
      -   Reading chromosome chr8 (pos=3084568)
      -   Allocation genotype vector  npeople=19 nvars=6400000
      -   GenotypeMatrix: allocating 115 MB of memory
      -         3815332 variants read -     3320415 variants kept -    1249 MB - speed:    327.56 MB/sec 
      -   Reading chromosome chr9 (pos=3417048)
      -   Reading chromosome chr10 (pos=3702610)
      -   Reading chromosome chr11 (pos=4016166)
      -         4765731 variants read -     4138153 variants kept -    1561 MB - speed:    331.21 MB/sec 
      -   Reading chromosome chr12 (pos=4326147)
      -   Reading chromosome chr13 (pos=4632581)
      -   Reading chromosome chr14 (pos=4870703)
      -         5716726 variants read -     4943736 variants kept -    1874 MB - speed:    330.49 MB/sec 
      -   Reading chromosome chr15 (pos=5060365)
      -   Reading chromosome chr16 (pos=5249337)
      -   Reading chromosome chr17 (pos=5442432)
      -   Reading chromosome chr18 (pos=5633893)
      -         6662668 variants read -     5756457 variants kept -    2186 MB - speed:    333.68 MB/sec 
      -   Reading chromosome chr19 (pos=5811431)
      -   Reading chromosome chr20 (pos=5967370)
      -   Reading chromosome chr21 (pos=6134546)
      -   Reading chromosome chr22 (pos=6236184)
      -   Reading chromosome chrX (pos=6346186)
      -   Allocation genotype vector  npeople=19 nvars=12800000
      -   GenotypeMatrix: allocating 231 MB of memory
      -   Reading chromosome chrY (pos=6514882)
      -   Chromosome  chr1    Markers   487717    Cumulative   487717
      -   Chromosome  chr2    Markers   523319    Cumulative  1011036
      -   Chromosome  chr3    Markers   438125    Cumulative  1449161
      -   Chromosome  chr4    Markers   453640    Cumulative  1902801
      -   Chromosome  chr5    Markers   399460    Cumulative  2302261
      -   Chromosome  chr6    Markers   415024    Cumulative  2717285
      -   Chromosome  chr7    Markers   367283    Cumulative  3084568
      -   Chromosome  chr8    Markers   332480    Cumulative  3417048
      -   Chromosome  chr9    Markers   285562    Cumulative  3702610
      -   Chromosome chr10    Markers   313556    Cumulative  4016166
      -   Chromosome chr11    Markers   309981    Cumulative  4326147
      -   Chromosome chr12    Markers   306434    Cumulative  4632581
      -   Chromosome chr13    Markers   238122    Cumulative  4870703
      -   Chromosome chr14    Markers   189662    Cumulative  5060365
      -   Chromosome chr15    Markers   188972    Cumulative  5249337
      -   Chromosome chr16    Markers   193095    Cumulative  5442432
      -   Chromosome chr17    Markers   191461    Cumulative  5633893
      -   Chromosome chr18    Markers   177538    Cumulative  5811431
      -   Chromosome chr19    Markers   155939    Cumulative  5967370
      -   Chromosome chr20    Markers   167176    Cumulative  6134546
      -   Chromosome chr21    Markers   101638    Cumulative  6236184
      -   Chromosome chr22    Markers   110002    Cumulative  6346186
      -   Chromosome  chrX    Markers   168696    Cumulative  6514882
      -   Chromosome  chrY    Markers     5159    Cumulative  6520041

[*]  Finished reading input files:  7548.04 ms 

      -   Expected IBS for unrelated pairs: p.IBS0 = 0.0751  p.IBS1 = 0.4515  p.IBS2 = 0.4733
      -   X-chromosome: pIBS2(X/X) = 0.6239 pIBS2(X/XX) = 0.1880   Mean MAF = 0.2843
      -   (ibs_est)   480 p=0.924856 perr=0.000000
      -   (ibs_est)    51 p=0.473318 perr=0.000000
      -   (ibs_est)  X_X    39 p=0.376057 perr=0.000000
      -   (ibs_est)  X_X   180 p=0.811972 perr=0.000000
      -   (ibs_est) Thresholds for defining regions as IBD1 = 480, IBD2 = 51
      -   (ibs_est) Inflation at edges IBS1 = 24.6, IBS2 = 2.2
      -   Genome size: 2947475.236 kb
      -   gs_threshold=24211.184044
      -   (ibs_est) Adjust segment size to 24211 markers (from 480)
      -   IBS1 threshold : 0.06 % of genome  (4000 markers) 
      -   IBS2 threshold : 0.01 % of genome  (500 markers) 



[*]  Starting IBD segment analysis

[*]  Estimated heterozygosity rate = 0.37637 

      -   Allocation genotype vector transposed npeople=4 nvars=6520042
      -   GenotypeMatrixTransposed: allocating 24 MB of memory

[*]  Reading sex information file: (null)
      -   No sex file specified
      -   Warning: Sample IHCAPX8-1 has no available sex information.
      -   Warning: Sample IHCAPX8-2 has no available sex information.
      -   Warning: Sample IHCAPX8-3 has no available sex information.


[*]  Genotype pre-processing duration:  7926.39 ms 

 -  Compute IBD by IBS: (cpu=4/4) Nind = 3 Nvar = 6520042
 -  Compute IBD by IBS: (cpu=1/4) Nind = 3 Nvar = 6520042
 -  Compute IBD by IBS: (cpu=3/4) Nind = 3 Nvar = 6520042
 -  Compute IBD by IBS: (cpu=2/4) Nind = 3 Nvar = 6520042

[*] Finished processing 

      -   Total time for analysis was 0.13 minutes (7.9 seconds)


Number of IBD segments identified:
57

Done.
Mon Jun 20 14:40:21 UTC 2022

